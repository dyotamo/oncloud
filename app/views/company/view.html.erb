<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.54.0/mapbox-gl.js'></script>
<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.54.0/mapbox-gl.css' rel='stylesheet' />
<%= render "shared/header", value: "" %>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-5">
    <h4>
      <strong><%= @company.name %></strong>
    </h4>
    <div class="well">
      <div>
        <div class="company-info-name"> Location </div>
        <div class="company-info-value">
          <span><%= @company.address %></span>
        </div>
      </div>
      <div>
        <div class="company-info-name"> City </div>
        <div class="company-info-value">
          <span><%= @company.city %></span>
        </div>
      </div>
      <div>
        <div class="company-info-name"> Category </div>
        <div class="company-info-value">
          <span><%= @company.category %></span>
        </div>
      </div>
      <div>
        <div class="company-info-name"> Website </div>
        <div class="company-info-value">
          <span><%= link_to @company.website, @company.website, target: "_blank" %></span>
        </div>
      </div>
      <div>
        <div class="company-info-name"> About </div>
        <div class="company-info-value">
          <span><%= @company.description %></span>
        </div>
      </div>
    </div>
    <div id="map" style="width: 100%; height: 300px;">
    </div>
  </div>
  <div class="col-md-2">
    <h4>Related companies:</h4>
    <ul>
      <% Company.where(category: @company.category).shuffle[0..7].each do |related|%>
        <li><%= link_to related.name, company_path(related.slug) %></li>
      <% end %>
      <li><%= link_to "More...", search_path(q: @company.category) %></li>
    </ul>
  </div>
</div>
<script>
  mapboxgl.accessToken = '<%= Rails.application.credentials.maps_access_token %>';
  
  var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/outdoors-v11',
    center: [32.6106835, -25.8962586], // Maputo for a while
    zoom: 13
  });
  
  map.scrollZoom.disable();
</script>
